# 🤖 WhatsApp 群聊记账机器人 - Electron 桌面版

一个基于 Electron 的 WhatsApp 群聊资金管理机器人，提供现代化的桌面应用界面。

## ✨ 功能特性

- 📱 **WhatsApp 集成**: 自动监控群聊消息，支持资金管理和计算
- 🖥️ **桌面应用**: 基于 Electron 的现代化桌面界面
- 📊 **实时数据**: 实时显示群组资金状态和操作历史
- 🔄 **系统托盘**: 后台运行，支持系统托盘操作
- 📈 **数据管理**: 支持数据导出、历史记录查看
- 🎯 **权限控制**: 管理员权限验证，确保操作安全

## 🚀 快速开始

### 环境要求

- Node.js 16+ 
- Windows 10/11
- Google Chrome 浏览器

### 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd WhatsAppRobot2.0
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **启动应用**
   ```bash
   npm start
   ```
   
   或者双击运行 `start-electron.bat`

## 📱 使用说明

### 首次使用

1. 启动应用后，点击"连接 WhatsApp"按钮
2. 扫描显示的二维码登录 WhatsApp
3. 登录成功后，机器人将自动监控群聊消息

### 群组管理

- **查看群组**: 左侧显示所有监控的群组列表
- **选择群组**: 点击群组名称进入管理界面
- **资金概览**: 查看当前资金、操作次数、活跃用户数

### 操作功能

#### 计算操作
- 输入计算表达式，如：`(current)+100` 或 `资金+1000`
- 使用 `current` 表示当前资金
- 点击"执行计算"按钮

#### 管理操作
- **撤销操作**: 撤销最后一次操作
- **重置群组**: 重置群组资金为 0
- **清理历史**: 清理指定天数前的历史记录

### WhatsApp 群聊命令

#### 资金记账
```
记账 100
记账 50.5
```
- 格式：`记账 <金额>`
- 需要管理员权限

#### 资金计算
```
计算 (current)+100
计算 资金*1.1
计算 当前资金-50
```
- 格式：`计算 <表达式>`
- 支持数学运算和变量引用
- 需要管理员权限

#### 查询功能
```
查询
账单
明细
统计
资金
```
- `查询` 或 `账单`: 显示群组概览
- `明细`: 显示详细操作历史
- `统计`: 显示统计数据
- `资金`: 显示当前资金

#### 管理操作
```
撤销
重置
清理 30
```
- `撤销`: 撤销最后一次操作
- `重置`: 重置群组资金
- `清理 <天数>`: 清理指定天数前的历史

#### 帮助信息
```
帮助
```
显示所有可用命令的说明

## 🛠️ 开发

### 项目结构

```
WhatsAppRobot2.0/
├── electron-main.js          # Electron 主进程
├── electron-app/             # 前端界面
│   ├── index.html           # 主界面
│   ├── app.js              # 前端逻辑
│   └── styles.css          # 样式文件
├── database.js              # 数据管理
├── messageParser.js         # 消息解析
├── responseGenerator.js     # 响应生成
├── config.js               # 配置文件
└── data/                   # 数据存储
```

### 开发模式

```bash
npm run dev
```

### 构建应用

```bash
# 打包应用
npm run pack

# 构建安装包
npm run dist
```

## ⚙️ 配置

### 管理员设置

在 `config.js` 中配置管理员：

```javascript
const admins = [
    'admin1@whatsapp.com',
    'admin2@whatsapp.com'
];
```

### 数据存储

- 数据文件存储在 `data/` 目录
- 每个群组一个独立的 JSON 文件
- 自动备份和恢复

## 🔧 故障排除

### 常见问题

1. **Chrome 浏览器未找到**
   - 确保已安装 Google Chrome
   - 检查 Chrome 安装路径

2. **WhatsApp 连接失败**
   - 检查网络连接
   - 重新扫描二维码
   - 清除认证缓存

3. **权限错误**
   - 确认用户为群组管理员
   - 检查配置文件中的管理员设置

### 日志查看

应用运行时会在控制台显示详细日志，包括：
- WhatsApp 连接状态
- 消息处理过程
- 错误信息

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

---

**注意**: 请遵守 WhatsApp 的使用条款，合理使用机器人功能。
